Behav Genet
Behavior Genetics
0001-8244
1573-3297
Kluwer Academic Publishers-Plenum Publishers
New York


1914301
17534709
9156
10.1007/s10519-007-9156-1
Original Paper


Variance Decomposition Using an IRT Measurement Model

van den Berg
Stéphanie M.

+31-20-5988824
+31-20-5988832
SM.van.den.Berg@psy.vu.nl

1

Glas
Cees A. W.

2

Boomsma
Dorret I.

1

1
Department of Biological Psychology, Vrije Universiteit Amsterdam, Van der Boechorststraat 1, Amsterdam, 1081 BT The Netherlands 
2
Department of Research Methodology, Measurement, and Data Analysis, University of Twente, Enschede, The Netherlands 

30
5
2007

7
2007

37
4
604
616
23
8
2005

12
4
2007


© Springer Science+Business Media, LLC 2007

Large scale research projects in behaviour genetics and genetic epidemiology are often based on questionnaire or interview data. Typically, a number of items is presented to a number of subjects, the subjects’ sum scores on the items are computed, and the variance of sum scores is decomposed into a number of variance components. This paper discusses several disadvantages of the approach of analysing sum scores, such as the attenuation of correlations amongst sum scores due to their unreliability. It is shown that the framework of Item Response Theory (IRT) offers a solution to most of these problems. We argue that an IRT approach in combination with Markov chain Monte Carlo (MCMC) estimation provides a flexible and efficient framework for modelling behavioural phenotypes. Next, we use data simulation to illustrate the potentially huge bias in estimating variance components on the basis of sum scores. We then apply the IRT approach with an analysis of attention problems in young adult twins where the variance decomposition model is extended with an IRT measurement model. We show that when estimating an IRT measurement model and a variance decomposition model simultaneously, the estimate for the heritability of attention problems increases from 40% (based on sum scores) to 73%.

Keywords
Item response theory
MCMC
Bayesian statistics
Measurement
Attention problems
Sum scores

issue-copyright-statement
© Springer Science+Business Media, LLC 2007




Introduction
2002a
) in which the covariance structures of monozygotic and dizygotic twins are compared.
1990
2001)
1998
1965
1961
). This method can also be used with ordinal data.
For some traits, it is convenient to have multiple indicators (items). For example one might have for a particular disease 10 symptoms that each can be scored as absent (0) or present (1). For each individual one can then compute a sum score that indicates to what extent the individual is affected by the disease. Such sum scores usually show a normal distribution or do so after an appropriate transformation. It is typically assumed that the normally distributed scores or transformations thereof reflect a continuous interval scale and the variance of the sum scores is subsequently decomposed. This approach follows classical test theory (CTT) where it is assumed that the observed score (the sum score) is the aggregate of a true score and a random component, usually referred to as measurement error. When decomposing the variance of sum scores, the measurement error variance (the unreliability) ends up as part of the non-shared environmental variance. As a result, when the reliability of a scale is low (i.e., the measurement error is large) and the analysis is based on sum scores, the heritability of the actual trait is significantly underestimated.
Modelling sum scores is appropriate if the sum scores are highly reliable (for instance because they are based on a large number of correlated items) and well validated. Furthermore, there should be enough variation and the distribution should be more or less normal. Finally, there should be no data missing. If these requirements do not hold, item response theory (IRT) provides a well-established alternative to classical test theory. This paper introduces the basics of the IRT framework, after which its advantages over a sum score approach are discussed. Next, it is argued that IRT models should be estimated simultaneously with the variance decomposition model, which can be done using a Bayesian approach with Markov-chain Monte Carlo estimation. Lastly, a simulation study shows the potential bias when estimating variance components on the basis of sum scores and the Bayesian method is illustrated with an empirical data set on attention problems.

Item response theory models
θ
β
θ
j

θ
j

N
μ
σ
2
i
j
p
Y
ij

θ
j

β
i

β
i

1
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ p(Y_{{ij}} = 1) = \Phi (\theta _{j} - \beta _{i} ), $$\end{document}

\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ \Phi (.) $$\end{document}

i
j
θ
j

β
i

1943
1952
1953)
μ
σ
2
, can be estimated and can be interpreted as the covariance of the items: the larger the variance, the higher the reliability of the scale.
An alternative parameterisation replaces the normal ogive by a logistic curve, that is,
2
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ p(Y_{{ij}} = 1) = \Psi (\theta _{j} - \beta _{i} ), $$\end{document}


\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ \Psi (x) = \frac{{\exp (x)}} {{1 + \exp (x)}}. $$\end{document}


1960
θ
j

β
1980
).
α
i

i
 loads onto the latent trait, and the model becomes
3
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ p(Y_{{ij}} = 1|\theta _{j} ,\alpha _{i} ,\beta _{i} ) = \Psi (\alpha _{i} \theta _{j} - \beta _{i} ). $$\end{document}


αθ
β
α
θ
β
β
-parameters (they are scaled differently) but it only involves a reparameterisation.
α
α
α
 that is equal for all items together with a fixed variance of the latent trait.
μ
N
θ
j

. Alternatively one fixes one of the discrimination parameters to unity. Generally, however, this identification solution is not advisable, because the standard errors of the parameters blow up if the discrimination parameter chosen for the identification is poorly identified.

IRT models for polytomous data
Often, measurement is based on items or symptoms with more than two categories. For example, answers can be coded as 0 (not at all), 1 (somewhat, sometimes) and 2 (a lot, often). Typically in CTT approaches in behaviour genetics the sum of these item scores is regarded to represent a person’s score on the trait of interest and is used for the statistical inference.
1969
1982
1990
1997
M
m = 0
M − 
M 
m =
2003
).

Advantages of using an IRT framework compared to analysing sum scores
We will discuss four advantages of using IRT: (1) it supports construct validity and the scoring rule (e.g., a scoring rule might consist of taking the unweighted sum of symptoms as an estimate of a person’s liability), (2) it supports the use of incomplete item administration designs and handling of missing data, (3) it supports accounting for measurement error, and (4) it can handle floor and ceiling effects.
An IRT framework allows one to explicitly model the relationship between item scores and the phenotype of interest. Any combination of items can of course be summed (weighted or unweighted), but this does not guarantee that the sum score reflects a meaningful construct. The meaningfulness of the measurement can be directly assessed in an IRT framework. Fit to an IRT model is empirical evidence that the observed responses can be explained by an underlying structure. The latent variable of the IRT model should, of course, be an appropriate representation of the construct to be measured.
θ
j

1968
). So some items can be more important or sensitive indicators of a trait than others. Modelling the item data in a variance decomposition analysis allows the separate evaluation of model fit regarding the measurement model and the variance decomposition model.
β
α
-parameters across groups). Such violations of measurement invariance are usually referred to as differential item functioning (DIF).
1987
2000
2000
2005
). The encompassing framework for handling missing data using IRT offers an important advantage over classical test theory. In classical test theory sum scores are only meaningful if the items are the same in all individuals and at all measurement waves.
latent
2001
2003
). These so-called latent correlations can be seen as estimates of correlations corrected for attenuation. A simulation study and an application of IRT to real data in a later section will show the possible extent of such attenuation effects on the estimation of heritability.
2003
2004
2004
). In an IRT framework one is essentially free to specify the distribution of the latent trait (in some cases, it can even be estimated). In most cases, with polygenic traits, a normal distribution seems the most reasonable alternative (a mixture approach may be more suitable for traits with only a few large QTL effects). When in turn the variance of the normally distributed latent trait is decomposed into genetic and non-genetic variance, the inference is unbiased if the assumptions of the model are correct.

Variance decomposition: the one-step and the two-step approach
θ
j

θ
j

θ
j

s as observed values in a standard variance decomposition analysis. This we call the two-step approach.
There are several disadvantages to this two-step approach. First of all, in the IRT model fitting phase, the usual IRT estimation software cannot handle the dependency in the data inherent in twin and family designs. In some cases, with simple designs such as with sibling pairs only, weighting of the data would come a long way in solving this problem, but with more complex family designs, weighting is not a satisfactory solution.
θ
j

β
θ
α
), whereas in the variance decomposition, it is assumed that measurement error (as included in the non-shared environmental variance component) is independent of location (cf. CTT). For example, many psychopathology scales have only items that refer to relatively rare symptoms. As a consequence, many individuals in the general population score 0, which does not necessarily imply that all actually have the trait to the exact same degree. In other words, the scale provides very little information on the trait on the low end. In contrast, the upper end of the scale usually shows more variation, which may imply that the measures are more reliable (more items that discriminate between individuals). Thus, a priori it seems likely that psychopathological scales have more discriminatory power at the upper end of the scale than at the lower end. Of course, this is not a bad thing, since these scales were designed to discriminate between the healthy and the sick. Therefore it seems reasonable to forego the assumption of equal reliability across the scale and take differing reliabilities into account.
Actually, using the two-step approach the heritability coefficient estimate will be about the same as when the analysis is carried out on sum scores. This is because IRT estimates and sum scores correlate highly, well over 0.90 in the case of two-parameter models. When applying a one-parameter model, the correlation will be practically one, because a basic assumption of the Rasch model is that a sum score is a sufficient statistic for the score on the latent trait. Therefore, all persons with the same sum score will get the same estimate on the latent trait. Thus, a third problem of the two-step approach is that it neither solves the attenuation problem, nor the non-normality, nor the ceiling effects.
In order to take full advantage of the IRT approach, it is critical to estimate both the measurement model and the variance decomposition model simultaneously, using a one-step approach. However, computationally this is rather challenging. Below, it is shown how this can be done using software for Bayesian estimation procedures. In an application in a later section, we demonstrate the one-step approach for the estimation of heritability with both simulated and empirical data.

Bayesian estimation using a Markov chain Monte Carlo algorithm 
2005
2005
).
P
η
Y
η
Y
P
η
Y
P
Y
η
η
P
η
), that is,
4
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ P\;(\eta {\text{ $|$ }}Y)\; \propto \;P(Y{\text{ $|$ }}\eta )P(\eta ). $$\end{document}


η
prior
P
Y
η
posterior
η
η
η
1973
2004
).
η
η
1984
1990
2004
), which is a special case of an MCMC algorithm. When however the conditional posterior distribution of a subset of the parameters is not easy or even impossible to sample from directly, other MCMC algorithms can be used, where one samples from a similar proposal distribution and uses a decision rule to either accept or reject a sample so that the accepted values can be regarded drawings from the target distribution.
In each iteration of an MCMC algorithm, a sample is taken from each conditional posterior distribution for each subset of the parameter space, given the current values of the other parameters. After a number of so-called ‘‘burn-in’’ iterations, necessary for a chain to achieve stationarity (i.e., approaching the target distribution: the joint posterior distribution) sufficiently closely, the subsequent draws can be regarded as sampled from the joint posterior distribution.
1999a
b)
1999
2000
1997
2001
2003)
2000
2001
2005
2004
).
1992
1999a
http://www.mrc-bsu.cam.ac.uk/bugs/
).
θ
2006a
):
5
\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{mathrsfs}
\usepackage{upgreek}
\setlength{\oddsidemargin}{-69pt}
\begin{document}$$ \theta _{{jk}} = a{\text{1}}_{k} + a{\text{2}}_{{jk}} + c_{k} + e_{{jk}} , $$\end{document}

c
k

k
e
jk

j
k
a
a
1970
a
a
a
a
a
a
a
a
a
a
N
σ
2
a

a
N
σ
2
a

c
N
σ
2
c

e ∼
N
σ
2
e

).
2006a
2006a
2004
1986
).

Simulation
β
 parameter values ranged from 0.5 to 3.5, with increments of 0.25. This corresponds to questionnaire items that are rarely endorsed by people. The simulated item data were fitted using a model with additive genetic and non-shared environmental effects (AE model) on a latent trait and a 1PL measurement model.
Next, sum scores were computed and these were analysed with an AE model. Since the distribution of the sum scores is positively skewed, the AE analysis was also performed after a logarithmic transformation of the sum scores.
The simulations were carried out using the software package . For each replicated data set, we computed the twin correlations for the latent scores, the twin correlations of the sum scores and the twin correlations for the log-transformed sum scores. The three types of analyses were carried out in WinBUGS. After a burn-in phase of 1000 iterations, the characterisation of the posterior distribution for the model parameters was based on 1000 iterations from 2 independent Markov chains. From each of the 3 (analyses) * 101 (replicated data sets) marginal posterior distributions for the heritability we took the mean and the median as point estimates.
2004
2003
). Third, we varied the number of items (5, 10, 20, 50, 100) to investigate attenuation.

Simulation results
Taking the median parameter values from the 101 data sets, the simulated latent data correlated 0.72 in MZ twins and 0.36 in DZ twins, just as would be expected. The sum scores correlated 0.45 in MZ twins and 0.21 in DZ twins (medians of the 101 data sets) and the log-transformed sum scores correlated 0.41 and 0.20, respectively. Thus, twin correlations are severely attenuated when analysing sum scores, even with 14 items.
1
Table 1
Simulation results. Reported heritability values are the medians of the 101 posterior means and medians, standard deviations between parentheses

Method of analysis
Heritability coefficient point estimates

Posterior mean
Posterior median


1PL IRT model
0.7232 (0.0585)
0.7245 (0.0589)

Sum scores continuous model
0.4364 (0.0393)
0.4369 (0.0395)

Log-transformed sum scores
0.4046 (0.0403)
0.4047 (0.0406)





1
Fig 1
β
 parameters (entire scale or only top half, i.e., all > 0)




1
β
 values in terms of the SD, so that the expected proportion of individuals scoring a particular number of items remains equal across simulation situation; the resultant distribution of the sum scores will be equal. But now, due to the decreased sensitivity of the scale, the number of items has a more pronounced effect on the attenuation. The sum score correlations are now lower than under the model with variance = 1. However, the attenuation effect is still proportional to the true correlations.
1
C shows an extreme situation where the items have high discriminatory power. The variance is now 100, and the items are evenly scattered between −25 and 25. Note that again, we retain the scatter of the beta values in terms of the SD, and again the sum score distribution will not be different from the earlier simulations. However, with such a sensitive scale, practically everybody that scores less than 1 SD below the mean will show a sum score of 16% of the total number of items. Everybody with a latent score higher than 1 SD below the mean will show a sum score of 84% of the number of items. Moreover, the data will show a scalogram pattern, for example with 3 items with increasing difficulty, the only observed patterns will be 111, 110, 100 and 000. Such a pattern will not be observed when the variance is 1, and even less so with a variance of 0.767: more individuals will then show patterns like 101 and 011, etc. Again, attenuation occurs when the number of items is limited, but the effect is much less pronounced, and again the attenuation is proportional across the different correlations. In this situation, an analysis of sum scores will yield reasonable estimates for the variance components given a sufficient number of items.
1998
2004
2004
1
1
D, but with 5 items, the simulated sum score correlation is 0.83667 when the true correlation is 0.9 (92.96%), 0.42429 when the true correlation is 0.5 (84.86%), and 0.076575 when the true correlation is 0.1 (76.58%). Suppose we could analyse the true correlations, 0.9 and 0.5. One would then conclude that additive genetic variance accounts for 80% of the variance, non-shared environmental effects 10% and the shared environmental effects for the remaining 10%. Now if we would base our analysis on the observed sum score correlations 0.84 and 0.42, we would conclude that there are no shared environmental effects. One can imagine that when the true correlations are 0.90 and 0.45 one would conclude dominance effects to be absent, whereas if one would analyse observed sum scores correlations, one would find evidence for dominance genetic variance, the extent of which is dependent on the number of items.
1
β
 parameters larger than the average latent score). Again we see that under the usual IRT model, the attenuation effect depends on the number of items and again we see that due to the skewness of the sum score distribution, the attenuation is not proportional to the true correlation. For example, with five items the simulated sum score correlation equals 0.591256 for true correlation 0.9 (66%), 0.316222 for true correlation 0.5 (63%), and 0.056567 for true correlation 0.1 (57%). When true correlations are again 0.9 and 0.5, the most likely model would be, when based on an analysis of the sum scores with 5 items, 5% dominance genetic variance, 61% additive genetic variance and 34% non-shared environmental variance.
Thus, also under the IRT model, analysing sum scores leads to an underestimation of shared environmental effects and an overestimation of dominance genetic effects when the sum score distributions are skewed.

An application
2002b
1997
2006c
).
2
2004
2006c
Table 2
1997
)

Item
Description


1
I act too young for my age

2
I have trouble concentrating or paying attention

3
I daydream a lot 

4
My school work or job performance is poor

5
I am too dependent on others 

6
I fail to finish things I should do

7
My behaviour is irresponsible





δ
β
β
β
δ
2006a
). The appendix gives the WinBUGS script. Three independent MCMC chains were used with randomised starting values. The chains converged rapidly to the stationary distribution with relatively low autocorrelations. The first 1000 iterations were discarded as burn-in samples, and a further 1000 iterations were used for inference.

Results 
3
β
Table 3
Descriptives of marginal posterior distributions for the AE variance decomposition model using the 1PL IRT model for polytomous items with a main effect for sex

Parameter
Mean
SD
2½th percentile
Median
97½th percentile


σ
2
a

0.84
0.07
0.71
0.84
0.99

σ
2
e

0.32
0.06
0.20
0.32
0.44

δ

−0.13
0.05
−0.24
−0.13
−0.02

β
11

0.25
0.05
0.15
0.25
0.34

β
12

2.76
0.10
2.56
2.76
2.96

β
21

−0.76
0.05
−0.86
−0.76
−0.66

β
22

2.44
0.08
2.30
2.45
2.60

β
31

−0.43
0.05
−0.53
−0.43
−0.33

β
32

1.84
0.08
1.71
1.84
1.98

β
41

1.90
0.06
1.78
1.90
2.02

β
42

3.96
0.20
3.58
3.96
4.36

β
51

0.22
0.05
0.13
0.22
0.32

β
52

3.03
0.10
2.83
3.02
3.23

β
61

0.62
0.05
0.53
0.62
0.73

β
62

3.90
0.15
3.63
3.90
4.19

β
71

2.57
0.07
2.44
2.57
2.71

β
72

4.61
0.31
4.05
4.60
5.27

h
2

0.73
0.05
0.63
0.72
0.82



Note
1
) and the second to the threshold



2006c
). In the current sample, twin correlations for sum scores are very much like those reported earlier (MZ:0.45, DZ:0.17). By applying an IRT measurement model the twin correlation estimates for the latent trait are much higher, 0.76 for MZ twins and 0.30 for DZ twins. For comparison, when using a two-step approach, first estimating IRT model parameters in Multilog and then estimating latent scores for each individual (correlation between sum score and IRT estimate: 0.98), the results showed twin correlations nearly identical to those based on sum scores.
α
γ
γ
N
(0, 100). In this case, the heritability estimate was not affected by this extension of the model (results not shown).

Discussion
1998
).
2004
2004
2006b
).
2004
2003
).
Moreover, when the measurement model and the variance decomposition model are estimated simultaneously, the variance decomposition deals appropriately with the dependency in the data when estimating IRT model parameters and testing the model’s assumptions, and the IRT measurement model deals appropriately with the estimation of the heritability coefficient (correcting for attenuation to obtain an unbiased point estimate) and the reporting of the confidence intervals (correcting for location-dependent uncertainty of person scores on the latent trait).
2006c
), a heritability estimate of 73% was obtained when including a measurement model and estimating it simultaneously with the variance decomposition model. This example provides an additional illustration of the bias in variance components due to the analysis of sum scores. However, it should be noted that model fit was not assessed, nor was the assumption of measurement invariance tested. This requires further study.
The crucial element of the one-step approach that leads to unbiased point estimates is the inclusion of the appropriate probabilistic measurement model so that the estimation takes into account the unreliability of the measurement. The probabilistic modelling allows for the fact that twins with identical response patterns may have different scores on the latent trait, and also, that twins with non-identical response patterns may have exactly the same score on the latent trait. Discriminatory power of the items and the number of items are both crucial to the heritability estimated based on sum scores: the fewer the items and the worse the discrimination of the items (i.e., the smaller the variance of the latent trait in the one-parameter model; the smaller the factor loadings in the two-parameter model), the more biased the estimation will be when the analysis is performed on sum scores. High quality scales with a large number of items (say, more than 50) with high discriminatory power that are scattered across the entire scale can indeed be analysed with sum scores, but any other scale should be analysed using the IRT framework if one is interested in an unbiased heritability estimate with trustworthy confidence intervals.
Future work should focus on the assessment of model fit in the context of genetic models. It is only sensible to apply a one-step IRT approach when the data actually conform to an IRT measurement model. If data do not fit an IRT model, for instance when there is differential item functioning across subpopulations, the approach will still lead to biased estimates. A crucial first step therefore is assessing model fit and checking measurement invariance.


This work was supported by grants from the Netherlands Organisation for Scientific Research, NWO 575-25-006 and NWO 051-02-060, 668-772.

Appendix: WinBUGS script
AE decomposition with 1PL IRT measurement model and main effect of sex
# The model is parameterised using the sum of latent

# liabilities in a twin pair and the

# difference.

# Nfammz: number of MZ twin pairs, Nfamdz: number

# of DZ twin pairs, specified in the

# data matrix

k
i
th MZ twin pair;

# Ymz[i, 1] is a covariate that is not used in this analysis

# Ymz[i, 2] is a dummy code for sex of the first twin

# (1 = male), the next 14 data points relate # to the items

# for the first twin, Ymz[i, 17] is a dummy code for sex of 

# second twin, the last

# 14 datapoints relate to the second twin.

k
i
th DZ twin pair;

# Winbugs uses precision parameters instead of variance

# parameters for the distributions.

# tau.summz: the inverse of sigma2.summz, being the

# variance of the summed latent scores

# of MZ twin pairs.



 
 

Model

    {

    for(i in 1:Nfammz) 

        {

        Summz[i] ∼ dnorm(0, tau.summz)

        difmz[i] ∼ dnorm(0, tau.difmz)

            for( k in 3:16)

            {

            logit(p1[i,k]) <- (summz[i] + difmz[i])/2 + Ymz[i,2]*delta − beta[k − 2]

            Ymz[i,k] ∼ dbern(p1[i,k])

            }

            for(k in 18:31)

            {

            logit(p1[i,k]) <- (summz[i] − difmz[i])/2 + Ymz[i,17]*delta − beta[k − 17] 

            Ymz[i,k] ∼ dbern(p1[i,k])

            }

        }    

    for(i in 1:Nfamdz) 

        {

        sumdz[i] ∼ dnorm(0, tau.sumdz)

        difdz[i] ∼ dnorm(0, tau.difdz)

            for(k in 3:16)

            {

            logit(p2[i,k]) <- (sumdz[i] + difdz[i])/2 + Ydz[i,2]*delta − beta[k − 2] 

            Ydz[i,k] ∼ dbern(p2[i,k])

            }

             for(k in 18:31)

            {

            logit(p2[i,k]) <- (sumdz[i] − difdz[i])/2 + Ydz[i,17]*delta − beta[k − 17] 

            Ydz[i,k] ∼ dbern(p2[i,k])

            }

        }





# winbugs works with precision parameters, i.e., the

# inverted variances

tau.summz <- 1/sigma2.summz

tau.sumdz <- 1/sigma2.sumdz

tau.difmz <- 1/sigma2.difmz

tau.difdz <- 1/sigma2.difdz

# variance decomposition, see Van den Berg et al., Twin

# Res Hum Genet, 9(3), 334–342.

sigma2.summz <- 4*VarA + 2*VarE

sigma2.sumdz <- 3*VarA + 2*VarE

sigma2.difmz <- 2*VarE

sigma2.difdz <- VarA + 2*VarE

# specification of inverse gamma priors for variance

# components

VarA <- 1/invVarA

VarE <- 1/invVarE

invVarA ∼ dgamma(0.10, 0.10)

invVarE ∼ dgamma(0.10, 0.10)

# sample the heritability parameter

h2 <- VarA/(VarA + VarE)

# remaining priors

delta ∼ dnorm(0, 0.01) # the sex effect

for (i in 1:14)

{

beta[i] ∼ dnorm(0, 0.01) # item parameters

}

}






References
Achenbach
TM


Manual for the young adult self-report and young adult behavior checklist
1997
Burlington, VT
University of Vermont, Department of Psychiatry

Achenbach TM (1997) Manual for the young adult self-report and young adult behavior checklist. University of Vermont, Department of Psychiatry, Burlington, VT 

Albert
JH


Bayesian estimation of normal ogive item response functions using Gibbs sampling
J Educ Stat
1992
17
251
269
10.2307/1165149

Albert JH (1992) Bayesian estimation of normal ogive item response functions using Gibbs sampling. J Educ Stat 17:251–269 

Béguin
AA

Glas
CAW


MCMC estimation of multidimensional IRT models
Psychometrika
2001
66
541
562
10.1007/BF02296195

Béguin AA, Glas CAW (2001) MCMC estimation of multidimensional IRT models. Psychometrika 66:541–562 

Boomsma
DI

Busjahn
A

Peltonen
L


Classical twin studies and beyond
Nat Rev Genet
2002
3
872
882
10.1038/nrg932

12415317


Boomsma
DI

Molenaar
PCM


Using LISREL to analyze genetic and environmental covariance structure
Behav Genet
1986
16
237
250
10.1007/BF01070799

3755040


Boomsma
DI

Vink
JM

Beijsterveldt
CEM

Geus
EJC

Beem
AL

Mulder
EJCM

Riese
H



Netherlands Twin Register: a focus on longitudinal research
Twin Res
2002
5
401
406
10.1375/136905202320906174

12537867


Box
GEP

Tiao
GC


Bayesian inference in statistical analysis
1973
Reading, Mass
Addison-Wesly

Box GEP, Tiao GC (1973) Bayesian inference in statistical analysis. Addison-Wesly, Reading, Mass 

Bradlow
ET

Wainer
H

Wang
X


A Bayesian random effects model for testlets
Psychometrika
1999
64
153
168
10.1007/BF02294533

Bradlow ET, Wainer H, Wang X (1999) A Bayesian random effects model for testlets. Psychometrika 64:153–168 

Crittenden
LB


An interpretation of familial aggregation based on multiple genetic and environmental factors
Ann New York Acad Sci
1961
91
769
780
10.1111/j.1749-6632.1961.tb31106.x

13696504


De Boeck P, Wilson M (eds) (2004) Explanatory item response models: a generalized linear and nonlinear approach. Springer, New York, NJ

Derks
EM

Dolan
CV

Boomsma
DI


Effects of censoring on parameter estimates and power in genetic modeling
Twin Res
2004
7
659
669
10.1375/1369052042663832

15607017


Eaves
L

Erkanli
A

Silberg
J

Angold
A

Maes
HH

Foley
D


Application of Bayesian inference using Gibbs sampling to item-response theory modelling of multi-symptom genetic data
Behav Genet
2005
35
765
780
10.1007/s10519-005-7284-z

16273316


Eaves
L

Silberg
J

Foley
D

Bulik
C

Maes
H

Erkanli
A

Angold
A

Costello
EJ

Worthman
C


Genetic and environmental influences on the relative timing of pubertal change
Twin Res
2004
7
471
481
10.1375/1369052042335278

15527663


Falconer
DS


The inheritance of liability to certain diseases, estimated from the incidence among relatives
Ann Hum Genet
1965
29
51
71

Falconer DS (1965) The inheritance of liability to certain diseases, estimated from the incidence among relatives. Ann Hum Genet 29:51–71 

Fox
JP

Glas
CAW


Bayesian estimation of a multilevel IRT model using Gibbs sampling
Psychometrika
2001
66
271
288
10.1007/BF02294839

Fox JP, Glas CAW (2001) Bayesian estimation of a multilevel IRT model using Gibbs sampling. Psychometrika 66:271–288 

Fox
JP

Glas
CAW


Bayesian modeling of measurement error in predictor variables
Psychometrika
2003
68
169
191
10.1007/BF02294796

Fox JP, Glas CAW. (2003) Bayesian modeling of measurement error in predictor variables. Psychometrika 68:169–191 

Gelfand
AE

Smith
AFM


Sampling-based approaches to calculating marginal densities
J Am Stat Ass
1990
85
398
409
10.2307/2289776

Gelfand AE, Smith AFM (1990) Sampling-based approaches to calculating marginal densities. J Am Stat Ass 85:398–409 

Gelman
A

Carlin
JB

Stern
HS

Rubin
DB


Bayesian data analysis
2004
2
London
Chapman and Hall

Gelman A, Carlin JB, Stern HS, Rubin DB (2004) Bayesian data analysis, 2nd edn. Chapman and Hall, London 

Geman
S

Geman
D


Stochastic relaxation, Gibbs distributions and the Bayesian restoration of images
IEEE Trans Pattern Anal Mach Intell
1984
6
721
741

Geman S, Geman D (1984) Stochastic relaxation, Gibbs distributions and the Bayesian restoration of images. IEEE Trans Pattern Anal Mach Intell 6:721–741 

Glas
CAW


Detection of differential item functioning using Lagrange multiplier tests
Stat Sinica
1998
8
647
667

Glas CAW (1998) Detection of differential item functioning using Lagrange multiplier tests. Stat Sinica 8:647–667 

Hoijtink
H

Molenaar
IW


A multidimensional item response model: Constrained latent class analysis using the Gibbs Sampler and posterior predictive checks
Psychometrika
1997
62
171
189
10.1007/BF02295273

Hoijtink H, Molenaar IW (1997) A multidimensional item response model: Constrained latent class analysis using the Gibbs Sampler and posterior predictive checks. Psychometrika 62:171–189 

Holman
R

Glas
CAW


Modelling non-ignorable missing data mechanisms with item response theory models
Brit J Math Stat Psy
2005
58
1
17
10.1348/000711005X47168

Holman R, Glas CAW (2005) Modelling non-ignorable missing data mechanisms with item response theory models. Brit J Math Stat Psy, 58:1–17 

Janssen
R

Tuerlinckx
F

Meulders
M

Boeck
P


A hierarchical IRT model for criterion-referenced measurement
J Educ Behav Stat
2000
25
285
306
10.2307/1165207

Janssen R, Tuerlinckx F, Meulders M, de Boeck P (2000) A hierarchical IRT model for criterion-referenced measurement. J Educ Behav Stat 25:285–306 

Jinks
JL

Fulker
DW


Comparison of the biometrical genetical, MAVA, and classical approaches to the analysis of human behavior
Psych Bull
1970
73
311
349
10.1037/h0029135

Jinks JL, Fulker DW (1970) Comparison of the biometrical genetical, MAVA, and classical approaches to the analysis of human behavior. Psych Bull 73:311:349 

Lawley
DN


On problems connected with item selection and test construction
P Roy Soc Edinb A
1943
62
74
82

Lawley DN (1943) On problems connected with item selection and test construction. P Roy Soc Edinb A 62:74–82 

Little
RJA

Rubin
DB


Statistical analysis with missing data
1987
New York
John Wiley

Little RJA, Rubin DB (1987) Statistical analysis with missing data. John Wiley, New York 

Lord FM (1952) A theory of test scores. Psychometric Monograph No 7. Psychometric Society, New York

Lord
FM


The relation of test score to the trait underlying the test
Educ Psychol Meas
1953
13
517
548
10.1177/001316445301300401

Lord FM (1953) The relation of test score to the trait underlying the test. Educ Psychol Meas 13:517–548 

Lord
FM


Applications of item response theory to practical testing problems
1980
Hillsdale, NJ
Erlbaum

Lord FM (1980) Applications of item response theory to practical testing problems. Erlbaum, Hillsdale, NJ 

Lord FM, Novick MR (1968) Statistical theories of mental test scores. Addison-Wesley, Reading

Lubke
G

Dolan
C

Neale
MC


Implications of absence of measurement invariance for detecting sex limitation and genotype by environment interaction
Twin Res
2004
7
292
298
10.1375/136905204774200578

15193174


Lynch
M

Walsh
B


Genetics and analysis of quantitative traits
1998
Sunderland, MA
Sinauer

Lynch M, Walsh B (1998) Genetics and analysis of quantitative traits Sinauer, Sunderland, MA 

Masters
GN


A Rasch model for partial credit scoring
Psychometrika
1982
47
149
174
10.1007/BF02296272

Masters GN (1982) A Rasch model for partial credit scoring. Psychometrika 47:149–174 

Moustaki
I

Knott
M


Weighting for item non-response in attitude scales using latent variable models with covariates
J R Stat Soc Ser A
2000
163
445
459
10.1111/1467-985X.00177

Moustaki I, Knott M (2000) Weighting for item non-response in attitude scales using latent variable models with covariates. J R Stat Soc Ser A 163:445–459 

Moustaki I, O’Muircheartaigh C (2000) A one dimensional latent trait model to infer attitude from nonresponse for nominal data. Statistica 60:259–276

Patz
RJ

Junker
BW


A straightforward approach to Markov chain Monte Carlo methods for item response theory models
J Educ Behav Stat
1999
24
146
178
10.2307/1165199

Patz RJ, Junker BW (1999a) A straightforward approach to Markov chain Monte Carlo methods for item response theory models. J Educ Behav Stat 24:146–178 

Patz
RJ

Junker
BW


Applications and extensions of MCMC in IRT: Multiple item types, missing data, and rated responses
J Educ Behav Stat
1999
24
342
366
10.2307/1165367

Patz RJ, Junker BW (1999b) Applications and extensions of MCMC in IRT: Multiple item types, missing data, and rated responses. J Educ Behav Stat 24:342–366 

Rabe-Hesketh
S

Skrondal
A


Multilevel and longitudinal modeling using stata
2005
College Station, TX
Stata Press

Rabe-Hesketh S, Skrondal A (2005) Multilevel and longitudinal modeling using stata. Stata Press, College Station, TX 

Rasch G (1960) Probabilistic models for some intelligence and attainment tests. Danish Institute for Educational Research, Copenhagen

Rietveld
MJH

Hudziak
JJ

Bartels
M

Beijsterveldt
CEM

Boomsma
DI


Heritability of attention problems in children: longitudinal results from a study of twins, age 3 to 12
J Child Psychol & Psychiat
2004
45
577
588
10.1111/j.1469-7610.2004.00247.x

15055376


Risch
N


Linkage strategies for genetically complex traits, I: multilocus models
Am J Hum Genet
1990
46
222
228

2301392


Risch
N


The genetic epidemiology of cancer: Interpreting family and twin studies and their implications for molecular genetic approaches
Cancer Epidem Biomar
2001
10
733
741

Risch N (2001) The genetic epidemiology of cancer: Interpreting family and twin studies and their implications for molecular genetic approaches. Cancer Epidem Biomar 10:733–741 

Robert
CP

Casella
G


Monte Carlo statistical methods
2004
2
New York
Springer

Robert CP, Casella G (2004) Monte Carlo statistical methods, 2nd edn. Springer, New York 

Rubin DB, Thomas N (2001) Using parameter expansion to improve the performance of the EM algorithm for multidimensional IRT population-survey models. In: Boomsma A, van Duijn MAJ, Snijders TAB (eds) Essays on item response theory. Springer, New York, NJ, pp 193–204

Samejima F (1969) Estimation of latent ability using a pattern of graded scores. Psychometrika, Monograph Supplement, No. 17

Skrondal
A

Rabe-Hesketh
S


Generalized latent variable modeling
2004
London
Chapman and Hall/CRC

Skrondal A, Rabe-Hesketh S (2004) Generalized latent variable modeling. Chapman and Hall/CRC, London 

Thissen
D

Chen
WH

Bock
RD


Multilog (version 7) [Computer software]
2003
Lincolnwood, IL
Scientific Software International

Thissen D, Chen WH, Bock RD (2003) Multilog (version 7) [Computer software]. Scientific Software International, Lincolnwood, IL 

Tutz
G


Sequential item response models with an ordered response
Brit J Math Stat Psy
1990
43
39
55

Tutz G (1990) Sequential item response models with an ordered response. Brit J Math Stat Psy 43:39–55 

Berg
SM

Beem
L

Boomsma
DI


Fitting genetic models using MCMC algorithms with BUGS
Twin Res Hum Genet
2006
9
334
349
10.1375/twin.9.3.334

16790144


Berg
SM

Setiawan
A

Bartels
M

Polderman
TJC

Vaart
AW

Boomsma
DI


Individual differences in puberty onset in girls: Bayesian estimation of heritabilities and genetic correlations
Behav Genet
2006
36
261
270
10.1007/s10519-005-9022-y

16408250


Berg
SM

Willemsen
G

Geus
EJC

Boomsma
DI


Genetic etiology of stability of attention problems in young adulthood
Am J Med Genet, Part B: Neuropsych Genet
2006
141B
55
60
10.1002/ajmg.b.30251

Van den Berg SM, Willemsen G, de Geus EJC, Boomsma DI (2006c) Genetic etiology of stability of attention problems in young adulthood. Am J Med Genet, Part B: Neuropsych Genet 141B:55–60 

Oord
EJCG

Pickles
A

Waldman
ID


Normal variation and abnormality: an empirical study of the liability distributions underlying depression and delinquency
J Child Psychol Psych
2003
44
180
192
10.1111/1469-7610.00112

Van den Oord EJCG, Pickles A, Waldman ID (2003) Normal variation and abnormality: an empirical study of the liability distributions underlying depression and delinquency. J Child Psychol Psych 44:180–192 

Verhelst ND, Glas CAW, de Vries HH (1997) A steps model to analyze partial credit. In: van der Linden WJ, Hambleton RK (eds) Handbook of modern item response theory. Springer, New York, pp 123–138

Wainer H, Bradlow ET, Du Z (2000) Testlet response theory: an analog for the 3PL model useful in testlet-based adaptive testing. In: van der Linden WJ, Glas CAW (eds) Computerized adaptive testing: theory and practice. Kluwer Academic Publishers, Boston, MA, pp 245–269


Edited by Stacey Cherny




